<% layout('layouts/admin') %>
<section class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
    <h2 class="text-xl font-semibold tracking-tight text-slate-900"><%= pageHeading %></h2>

    <a href="<%= '/admin' + activePath.replace(/\/[^/]*$/, '') + '/new' %>"
       class="inline-flex items-center gap-2 rounded-lg bg-indigo-600 px-3.5 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-700 active:translate-y-[0.5px]">
      <i class="lucide lucide-plus"></i>
      <span>Thêm</span>
    </a>
  </div>

  <!-- Table Card -->
  <div class="rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead class="sticky top-0 z-10 bg-slate-50/95 backdrop-blur supports-[backdrop-filter]:bg-slate-50/80">
          <tr class="text-left text-slate-500 uppercase text-[11px]">
            <% fields.forEach(f=>{ %>
              <th class="p-3 font-semibold"><%= f %></th>
            <% }) %>
            <th class="p-3 w-32"></th>
          </tr>
        </thead>

        <tbody>
          <% (items||[]).forEach(it=>{ %>
            <tr class="border-t odd:bg-white even:bg-slate-50/40 hover:bg-indigo-50/40 transition-colors">
              <% fields.forEach(f=>{ %>
                <td class="p-3 align-middle whitespace-nowrap max-w-[320px]">
                  <div class="truncate text-slate-700"><%= (it[f]!==undefined && it[f]!==null) ? it[f] : (f==='items.length' && it.items ? it.items.length : '—') %></div>
                </td>
              <% }) %>
              <td class="p-3 text-right">
                <div class="inline-flex items-center gap-1">
                  <a class="inline-flex items-center gap-1 rounded-lg border border-transparent bg-blue-600 px-2.5 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-blue-700"
                     href="<%= activePath %>/<%= it._id || it.code || it.sku %>">
                    Sửa
                  </a>
                  <form action="<%= activePath %>/<%= it._id || it.code || it.sku %>/delete" method="post" class="inline"
                        onsubmit="return confirm('Xóa mục này?')">
                    <button class="inline-flex items-center gap-1 rounded-lg border border-transparent bg-rose-600 px-2.5 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-rose-700"
                            type="submit">
                      Xóa
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</section>
